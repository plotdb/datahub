var json0OtDiff,diffMatchPatch,editor,init,mhub;json0OtDiff=require("json0-ot-diff"),diffMatchPatch=require("diff-match-patch"),editor=function(t){var e,i=this;return null==t&&(t={}),this.opt=t,this.root=e=ld$.find(t.root,0),this.hub=new datahub.usr({scope:t.scope||[],render:function(t){return i.value=otJson0.type.apply(i.value,t),i.view.render()}}),t.hub?t.hub.pipe(this.hub):mhub.pipe(this.hub),this.value=this.hub.get()||{},this.view=new ldView({root:e,action:{input:{input:function(e){var r,o;return r=e.node,o=t.raw?json0OtDiff(i.value,JSON.parse(r.value),diffMatchPatch):json0OtDiff(i.value,{str:r.value},diffMatchPatch),i.hub.opsOut(o)}}},handler:{input:function(e){var r;return r=e.node,t.raw?r.value=JSON.stringify(i.value,null,2):r.value=i.value.str||""}}}),this},init=function(){var t;return t=new datahub({scope:["textarea2"]}),mhub.pipe(t),new editor({name:"editor1",root:"[ld-scope=editor1]",scope:[],raw:!0}),new editor({name:"editor2",root:"[ld-scope=editor2]",scope:["textarea1"]}),new editor({name:"editor3",root:"[ld-scope=editor3]",hub:t}),new editor({name:"editor4",root:"[ld-scope=editor4]",hub:t})},((mhub=new sharehub({id:"test2",create:function(){return{textarea1:{str:"hello"},textarea2:{str:"world"}}}})).init?mhub.init():Promise.resolve()).then(function(){return init()});